machine:
  # Version of ruby to use
  ruby:
    version:
      2.4.0

dependencies:
  pre:

    - sudo apt-get -y update
    - sudo apt-get -y install git-core curl zlib1g-dev build-essential libssl-dev libreadline-dev libyaml-dev libsqlite3-dev sqlite3 libxml2-dev libxslt1-dev libcurl4-openssl-dev python-software-properties libffi-dev nodejs
    - wget http://ftp.ruby-lang.org/pub/ruby/2.4/ruby-2.4.0.tar.gz
    - tar -xzvf ruby-2.4.0.tar.gz
    - cd ruby-2.4.0/
    - chmod +x configure
    - /bin/bash ./configure
    - sudo ./configure
    - make
    - sudo make install
    - gem install capistrano
    - git clone https://github.com/vsirius/capistrano.git
    - gem install bundler

test:
  override:
    - nosetests

deployment:
    commands:
      - cd capistrano
      - bundle install
      - bundle exec cap production deploy
